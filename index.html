<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Simulador de Leyes de Paneo</title><style>
:root{--bg:#f3f3f3;--card:#fff;--text-main:#333;--text-dim:#666;--accent:#0078d4;--border:#e0e0e0;--grid:#eee;--l:#0078d4;--r:#d83b01}
body{font-family:'Segoe UI',sans-serif;background:var(--bg);margin:0;height:100vh;display:flex;justify-content:center;align-items:center;overflow:hidden}
.a{width:98vw;height:95vh;display:grid;grid-template-columns:1fr 350px;gap:20px;padding:20px;box-sizing:border-box}
.b{background:var(--card);border:1px solid var(--border);border-radius:4px;padding:20px;display:flex;flex-direction:column;box-shadow:0 2px 4px rgba(0,0,0,0.05)}
.c{flex-grow:1;position:relative;margin:10px 0;background:#fff;min-height:300px}
canvas{position:absolute;top:0;left:0;width:100%;height:100%}
.t{font-size:14px;font-weight:700;color:var(--accent);margin-bottom:15px;text-transform:uppercase}
.f{display:flex;flex-direction:column;gap:15px;overflow-y:auto}
label{font-size:12px;color:var(--text-dim);margin:5px 0;display:block}
select,input[type=range]{width:100%;margin-bottom:12px;cursor:pointer}
.d{font-family:Consolas,monospace;font-size:13px;margin:4px 0}
.g{display:flex;gap:5px;margin-bottom:15px}
.g button{flex:1;padding:6px;cursor:pointer;border:1px solid var(--border);background:#fff}
.p{background:var(--accent);color:#fff;border:none;padding:12px;border-radius:4px;cursor:pointer;font-weight:700}
.p:hover{opacity:0.9}
.v{height:60px;margin-top:10px;border-top:1px solid var(--border);position:relative}
</style></head><body><div class="a"><div class="b"><div class="t">Representaci√≥n Gr√°fica</div><div class="c" id="cC"><canvas id="mC"></canvas></div><div class="v" id="sV"><canvas id="sC"></canvas></div></div><div class="f"><div class="b"><div class="t">Configuraci√≥n Inteligente</div><label>Ley Objetivo:</label><select id="lT"><option>-3 dB (Potencia Constante)</option><option>-4.5 dB (Compromiso)</option><option>-6 dB (Lineal)</option></select><label>Curva Matem√°tica (Taper):</label><select id="tT"><option>Taper Seno-Coseno</option><option>Taper Ra√≠z Cuadrada</option><option>Taper Lineal</option></select><label>Estilo de Consola:</label><select id="iS"><option>Atenuaci√≥n Central</option><option>Refuerzo Lateral</option></select></div><div class="b"><div class="t">Control & Audio</div><input type="range" id="pS" min="-1" max="1" step="0.01" value="0"><div class="g"><button onclick="v(-1)">L</button><button onclick="v(0)">C</button><button onclick="v(1)">R</button></div><div id="lL" class="d" style="color:var(--l)">L: --</div><div id="lR" class="d" style="color:var(--r)">R: --</div><button id="bP" class="p">‚ñ∂ Reproducir Audio (440Hz)</button></div><button onclick="x()" style="padding:10px;cursor:pointer;border:1px solid var(--border);background:#fff">üì∑ Guardar Gr√°fico</button></div></div>
<script>(function(){const _d=document,_m=Math,_g=e=>_d.getElementById(e),_lT=_g('lT'),_tT=_g('tT'),_iS=_g('iS'),_pS=_g('pS'),_bP=_g('bP'),_mC=_g('mC'),_sC=_g('sC');let _aC=null,_os=null,_gL=null,_gR=null,_pl=!1;
function _ca(_p,_l,_t,_s){const _ar=Array.isArray(_p)?_p:[_p];const _rs=_ar.map(_v=>{const _x=(_v+1)/2;const _rt=(_n,_k)=>{if(_k==='Taper Seno-Coseno')return[_m.cos(_n*_m.PI/2),_m.sin(_n*_m.PI/2)];if(_k==='Taper Ra√≠z Cuadrada')return[_m.sqrt(1-_n),_m.sqrt(_n)];return[1-_n,_n]};let _gl,_gr;if(_l==='-4.5 dB (Compromiso)'){const [_l1,_l2]=_rt(_x,'Taper Lineal'),[_p1,_p2]=_rt(_x,'Taper Seno-Coseno');_gl=_m.sqrt(_l1*_p1);_gr=_m.sqrt(_l2*_p2)}else{[_gl,_gr]=_rt(_x,_t)}if(_s==='Refuerzo Lateral'){let _cn;if(_l==='-4.5 dB (Compromiso)'){_cn=_m.sqrt(0.5*_m.cos(_m.PI*0.25))}else{_cn=_rt(0.5,_t)[0]}const _bt=1.0/_cn;_gl*=_bt;_gr*=_bt}return[_gl,_gr]});return Array.isArray(_p)?[_rs.map(r=>r[0]),_rs.map(r=>r[1])]:_rs[0]}
function _sz(_c){const _b=_c.parentNode.getBoundingClientRect(),_r=window.devicePixelRatio||1;_c.width=_b.width*_r;_c.height=_b.height*_r;const _ctx=_c.getContext('2d');_ctx.setTransform(_r,0,0,_r,0,0);return{ctx:_ctx,w:_b.width,h:_b.height}}
function _dw(){if(!_mC.parentNode.offsetWidth)return;const{ctx:_ctx,w:_w,h:_h}=_sz(_mC),_p=50,_gw=_w-2*_p,_gh=_h-2*_p;_ctx.clearRect(0,0,_w,_h);_ctx.strokeStyle='#eee';_ctx.lineWidth=1;for(let i=0;i<=10;i++){const x=_p+i*_gw/10,y=_p+i*_gh/10;_ctx.beginPath();_ctx.moveTo(x,_p);_ctx.lineTo(x,_h-_p);_ctx.stroke();_ctx.beginPath();_ctx.moveTo(_p,y);_ctx.lineTo(_w-_p,y);_ctx.stroke()}
const _dm=[];for(let i=0;i<=200;i++)_dm.push(-1+i/100);const [_ls,_rs]=_ca(_dm,_lT.value,_tT.value,_iS.value);const _mX=v=>_p+((v+1)/2)*_gw,_mY=v=>_h-_p-(v/1.5)*_gh;const _pt=(d,c,s)=>{_ctx.setLineDash(s);_ctx.strokeStyle=c;_ctx.lineWidth=2;_ctx.beginPath();d.forEach((v,i)=>{const x=_mX(_dm[i]),y=_mY(v);if(i===0)_ctx.moveTo(x,y);else _ctx.lineTo(x,y)});_ctx.stroke()};
_pt(_ls,'#0078d4',[]);_pt(_rs,'#d83b01',[]);_pt(_ls.map((v,i)=>v+_rs[i]),'#999',[5,5]);_pt(_ls.map((v,i)=>v*v+_rs[i]*_rs[i]),'#107c10',[2,2]);const _cp=parseFloat(_pS.value);_ctx.setLineDash([]);_ctx.strokeStyle='#0078d4';_ctx.lineWidth=1;_ctx.beginPath();_ctx.moveTo(_mX(_cp),_p);_ctx.lineTo(_mX(_cp),_h-_p);_ctx.stroke();
const [_gl,_gr]=_ca(_cp,_lT.value,_tT.value,_iS.value);const _dB=v=>v>0?(20*(_m.log(v)/_m.LN10)).toFixed(1):'-99';_g('lL').innerText='L: '+_gl.toFixed(2)+' ('+_dB(_gl)+' dB)';_g('lR').innerText='R: '+_gr.toFixed(2)+' ('+_dB(_gr)+' dB)';if(_pl&&_gL){const t=_aC.currentTime;_gL.gain.setTargetAtTime(_gl*0.3,t,0.02);_gR.gain.setTargetAtTime(_gr*0.3,t,0.02)}
const _sV=_sz(_sC),_cy=_sV.h/2;_sV.ctx.strokeStyle='#ccc';_sV.ctx.beginPath();_sV.ctx.moveTo(30,_cy);_sV.ctx.lineTo(_sV.w-30,_cy);_sV.ctx.stroke();const _px=30+(_cp+1)/2*(_sV.w-60);_sV.ctx.fillStyle='#0078d4';_sV.ctx.beginPath();_sV.ctx.arc(_px,_cy,6,0,7);_sV.ctx.fill()}
function _ic(){const l=_lT.value,o=_tT.options;if(l==='-6 dB (Lineal)'){_tT.value='Taper Lineal';o[0].disabled=o[1].disabled=!0}else if(l==='-3 dB (Potencia Constante)'){if(_tT.value==='Taper Lineal')_tT.value='Taper Seno-Coseno';o[2].disabled=!0;o[0].disabled=o[1].disabled=!1}else{for(let i of o)i.disabled=!1}_dw()}
_pS.oninput=_dw;_lT.onchange=_ic;_tT.onchange=_dw;_iS.onchange=_dw;window.v=function(n){_pS.value=n;_dw()};window.x=function(){const a=_d.createElement('a');a.download='paneo.png';a.href=_mC.toDataURL();a.click()};
_bP.onclick=function(){if(!_pl){_aC=new(window.AudioContext||window.webkitAudioContext)();_os=_aC.createOscillator();_gL=_aC.createGain();_gR=_aC.createGain();const m=_aC.createChannelMerger(2);_os.connect(_gL);_os.connect(_gR);_gL.connect(m,0,0);_gR.connect(m,0,1);m.connect(_aC.destination);_os.start();_pl=!0;this.innerText='‚¨õ Detener Audio'}else{_os.stop();_aC.close();_pl=!1;this.innerText='‚ñ∂ Reproducir Audio (440Hz)'}};
window.addEventListener('resize',_dw);setTimeout(_ic,100);})();</script></body></html>